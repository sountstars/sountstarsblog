<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jenkins自动化部署 | aurora blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/feature_cat.jpeg">
    <meta name="description" content="我的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.cb058343.css" as="style"><link rel="preload" href="/assets/js/app.157a43b5.js" as="script"><link rel="preload" href="/assets/js/2.52866a67.js" as="script"><link rel="preload" href="/assets/js/3.2452f598.js" as="script"><link rel="prefetch" href="/assets/js/10.010d567c.js"><link rel="prefetch" href="/assets/js/11.4af4b929.js"><link rel="prefetch" href="/assets/js/12.337cdcf1.js"><link rel="prefetch" href="/assets/js/13.90875d56.js"><link rel="prefetch" href="/assets/js/14.0ed7aefb.js"><link rel="prefetch" href="/assets/js/15.754a382b.js"><link rel="prefetch" href="/assets/js/16.cb862ad8.js"><link rel="prefetch" href="/assets/js/17.4fa3dc3a.js"><link rel="prefetch" href="/assets/js/18.19362ae0.js"><link rel="prefetch" href="/assets/js/19.bb38661a.js"><link rel="prefetch" href="/assets/js/20.9f6dac92.js"><link rel="prefetch" href="/assets/js/21.b86ba564.js"><link rel="prefetch" href="/assets/js/22.08390e2a.js"><link rel="prefetch" href="/assets/js/23.07ce8733.js"><link rel="prefetch" href="/assets/js/24.2224abb3.js"><link rel="prefetch" href="/assets/js/25.cf2cacb2.js"><link rel="prefetch" href="/assets/js/26.0fab9c3d.js"><link rel="prefetch" href="/assets/js/27.409f3c11.js"><link rel="prefetch" href="/assets/js/28.2d999655.js"><link rel="prefetch" href="/assets/js/29.4c4b34f2.js"><link rel="prefetch" href="/assets/js/30.c7e81ddc.js"><link rel="prefetch" href="/assets/js/31.87c49613.js"><link rel="prefetch" href="/assets/js/32.785f3b5f.js"><link rel="prefetch" href="/assets/js/33.d851ac79.js"><link rel="prefetch" href="/assets/js/34.f7dbbd6a.js"><link rel="prefetch" href="/assets/js/35.ecb758ea.js"><link rel="prefetch" href="/assets/js/36.478ee48d.js"><link rel="prefetch" href="/assets/js/37.b1e60efd.js"><link rel="prefetch" href="/assets/js/38.5b5e4eff.js"><link rel="prefetch" href="/assets/js/39.694373c0.js"><link rel="prefetch" href="/assets/js/4.e4d2375c.js"><link rel="prefetch" href="/assets/js/40.4a96b7b1.js"><link rel="prefetch" href="/assets/js/41.b0c17527.js"><link rel="prefetch" href="/assets/js/42.bb73ede6.js"><link rel="prefetch" href="/assets/js/43.dcd6c126.js"><link rel="prefetch" href="/assets/js/44.f643b2b9.js"><link rel="prefetch" href="/assets/js/45.194d68b8.js"><link rel="prefetch" href="/assets/js/46.a68230ef.js"><link rel="prefetch" href="/assets/js/47.0d19f838.js"><link rel="prefetch" href="/assets/js/48.d3f26e8c.js"><link rel="prefetch" href="/assets/js/49.b7740e4c.js"><link rel="prefetch" href="/assets/js/5.cb8c9fa9.js"><link rel="prefetch" href="/assets/js/50.2587ca2f.js"><link rel="prefetch" href="/assets/js/51.ea8d1c82.js"><link rel="prefetch" href="/assets/js/52.48ff45db.js"><link rel="prefetch" href="/assets/js/53.218b9ecf.js"><link rel="prefetch" href="/assets/js/54.1fa58f1d.js"><link rel="prefetch" href="/assets/js/55.d2ef0ce9.js"><link rel="prefetch" href="/assets/js/56.4a7bc600.js"><link rel="prefetch" href="/assets/js/57.b442bff3.js"><link rel="prefetch" href="/assets/js/58.542150a6.js"><link rel="prefetch" href="/assets/js/6.f0062c90.js"><link rel="prefetch" href="/assets/js/7.b156b7cb.js"><link rel="prefetch" href="/assets/js/8.dfb56ee2.js"><link rel="prefetch" href="/assets/js/9.f870735d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb058343.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">aurora blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/sountstars" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/sountstars" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>FE框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Servers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git命令</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Other</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/other/basic.html" aria-current="page" class="active sidebar-link">Jenkins自动化部署</a></li><li><a href="/other/master.html" class="sidebar-link">农业知识综合三</a></li><li><a href="/other/message.html" class="sidebar-link">农业信息化导论</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jenkins自动化部署"><a href="#jenkins自动化部署" class="header-anchor">#</a> Jenkins自动化部署</h1> <h3 id="安装插件"><a href="#安装插件" class="header-anchor">#</a> 安装插件</h3> <p>系统管理-&gt;插件管理-&gt;高级-&gt;升级的站点</p> <div class="language-js extra-class"><pre class="language-js"><code>Generic Webhook Trigger  <span class="token comment">//web触发器</span>

Publish Over <span class="token constant">SSH</span>  <span class="token comment">//通过ssh部署服务器</span>

nvm wrapper   <span class="token comment">//提供node环境 </span>

<span class="token comment">//这个我没装</span>
Role<span class="token operator">-</span>based Authorization Strategy<span class="token comment">//增加用户的权限管理</span>

</code></pre></div><h3 id="添加项目"><a href="#添加项目" class="header-anchor">#</a> 添加项目</h3> <p>新建一个任务[name]-&gt;构架一个自由风格的项目-&gt;确定
<img src="/assets/img/jenkins_1.821a89b0.jpg" alt="solar"></p> <ul><li>源代码-&gt;git-&gt;https://github.com/sountstars/sountstarsblog.git</li> <li>添加权限【git 的用户名和密码</li> <li>构建触发器(Generic Webhook Trigger)</li> <li>应用保存</li></ul> <p><img src="/assets/img/jenkins_2.fba47202.jpg" alt="solar"> <img src="/assets/img/jenkins_3.8f0c6024.jpg" alt="solar"></p> <h3 id="配置webhook"><a href="#配置webhook" class="header-anchor">#</a> 配置webhook</h3> <p>此时可以构建了，但是需要在还给Git中添加Webhooks，否则不能自动化构建
<img src="/assets/img/webhooks.c37ae2c7.jpg" alt="solar"></p> <p><code>http://JENKINS_URL/generic-webhook-trigger/invoke</code></p> <p>JENKINS_URL格式为 用户名:<code>http://admin:token@服务器ip:8081/generic-webhook-trigger/invoke</code></p> <p><strong>token生成位置</strong> <img src="/assets/img/new_token.5d99415f.jpg" alt="solar"></p> <h3 id="构建"><a href="#构建" class="header-anchor">#</a> 构建</h3> <p>-&gt; 下拉任务名字-&gt;配置-&gt;构建环境（选中Run the build in an NVM managed environment，【我们自己下载的插件提供node环境】）
-&gt; 输入node的版本号-&gt;构建-&gt;选择shell
<img src="/assets/img/build_environment.65727024.jpg" alt="solar"></p> <p><strong>构建时候执行命令</strong></p> <p><code>这里不能执行mv命令</code></p> <p><img src="/assets/img/build_command.fd5708e1.jpg" alt="solar"></p> <div class="language-js extra-class"><pre class="language-js"><code>cd <span class="token operator">/</span>home<span class="token operator">/</span>wwwroot
tar <span class="token operator">-</span>xzvf dist<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz 
rm <span class="token operator">-</span>rf dist
mv <span class="token operator">-</span>f docs<span class="token operator">/</span><span class="token punctuation">.</span>vuepress<span class="token operator">/</span>dist<span class="token operator">/</span>  <span class="token punctuation">.</span><span class="token operator">/</span>
</code></pre></div><h3 id="post-build-actions-的ssh-sercer-name-添加-添加服务器的私钥"><a href="#post-build-actions-的ssh-sercer-name-添加-添加服务器的私钥" class="header-anchor">#</a> Post-build Actions 的SSH Sercer Name 添加(添加服务器的私钥)</h3> <p>系统管理-&gt;系统设置-&gt;Publish over SSH
<code>username 生成密钥的账户</code> <img src="/assets/img/publish_ssh.f703a9e7.jpg" alt="solar"></p> <p><strong>配置免费登录（同一台也要）</strong> <code>这里不配置免登录，在部署的时候，找不到要部署的服务器</code>
ssh-keygen -t rsa
ssh-copy-id <code>IP</code></p> <h3 id="构建后操作"><a href="#构建后操作" class="header-anchor">#</a> 构建后操作</h3> <p>下拉任务名字-&gt;配置-&gt;构建后操作-&gt;Send build artifacts over SSH
<img src="/assets/img/send_build.f441d5e5.jpg" alt="solar"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/git/standard.html" class="prev">
        git常用规范
      </a></span> <span class="next"><a href="/other/master.html">
        农业知识综合三
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.157a43b5.js" defer></script><script src="/assets/js/2.52866a67.js" defer></script><script src="/assets/js/3.2452f598.js" defer></script>
  </body>
</html>
