<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React-Native基本用法 | aurora blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/feature_cat.jpeg">
    <meta name="description" content="我的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.cb058343.css" as="style"><link rel="preload" href="/assets/js/app.a4e80abf.js" as="script"><link rel="preload" href="/assets/js/2.52866a67.js" as="script"><link rel="preload" href="/assets/js/14.31a9b0f4.js" as="script"><link rel="prefetch" href="/assets/js/10.c90e4926.js"><link rel="prefetch" href="/assets/js/11.f7937699.js"><link rel="prefetch" href="/assets/js/12.9c5ad91f.js"><link rel="prefetch" href="/assets/js/13.409d7100.js"><link rel="prefetch" href="/assets/js/15.67e7098d.js"><link rel="prefetch" href="/assets/js/16.49b0b533.js"><link rel="prefetch" href="/assets/js/17.819bf99b.js"><link rel="prefetch" href="/assets/js/18.bac78a5c.js"><link rel="prefetch" href="/assets/js/19.eea90313.js"><link rel="prefetch" href="/assets/js/20.9f6dac92.js"><link rel="prefetch" href="/assets/js/21.b86ba564.js"><link rel="prefetch" href="/assets/js/22.5a781ad8.js"><link rel="prefetch" href="/assets/js/23.07ce8733.js"><link rel="prefetch" href="/assets/js/24.d413db0d.js"><link rel="prefetch" href="/assets/js/25.1f42cdf3.js"><link rel="prefetch" href="/assets/js/26.9b5d1e99.js"><link rel="prefetch" href="/assets/js/27.e3c3e73c.js"><link rel="prefetch" href="/assets/js/28.1cfe5699.js"><link rel="prefetch" href="/assets/js/29.fcfc4553.js"><link rel="prefetch" href="/assets/js/3.44126956.js"><link rel="prefetch" href="/assets/js/30.011bdae9.js"><link rel="prefetch" href="/assets/js/31.87c49613.js"><link rel="prefetch" href="/assets/js/32.785f3b5f.js"><link rel="prefetch" href="/assets/js/33.d851ac79.js"><link rel="prefetch" href="/assets/js/34.095dfd7c.js"><link rel="prefetch" href="/assets/js/35.175ac93c.js"><link rel="prefetch" href="/assets/js/36.cdb35651.js"><link rel="prefetch" href="/assets/js/37.b1e60efd.js"><link rel="prefetch" href="/assets/js/38.8fce9320.js"><link rel="prefetch" href="/assets/js/39.4bbc0262.js"><link rel="prefetch" href="/assets/js/4.6a086079.js"><link rel="prefetch" href="/assets/js/40.4a96b7b1.js"><link rel="prefetch" href="/assets/js/41.da3e737e.js"><link rel="prefetch" href="/assets/js/42.9d9b7976.js"><link rel="prefetch" href="/assets/js/43.d81e144f.js"><link rel="prefetch" href="/assets/js/44.afa7ffe0.js"><link rel="prefetch" href="/assets/js/45.194d68b8.js"><link rel="prefetch" href="/assets/js/46.09249766.js"><link rel="prefetch" href="/assets/js/47.27f0c266.js"><link rel="prefetch" href="/assets/js/48.7ed4ba3c.js"><link rel="prefetch" href="/assets/js/49.a13a482c.js"><link rel="prefetch" href="/assets/js/5.99ddc87c.js"><link rel="prefetch" href="/assets/js/50.8c1d37fc.js"><link rel="prefetch" href="/assets/js/51.ada440d7.js"><link rel="prefetch" href="/assets/js/52.babfc324.js"><link rel="prefetch" href="/assets/js/53.23dabc88.js"><link rel="prefetch" href="/assets/js/54.f55ea290.js"><link rel="prefetch" href="/assets/js/55.47814c34.js"><link rel="prefetch" href="/assets/js/56.9ca0ec63.js"><link rel="prefetch" href="/assets/js/57.b442bff3.js"><link rel="prefetch" href="/assets/js/58.542150a6.js"><link rel="prefetch" href="/assets/js/6.11773ee6.js"><link rel="prefetch" href="/assets/js/7.b156b7cb.js"><link rel="prefetch" href="/assets/js/8.dfb56ee2.js"><link rel="prefetch" href="/assets/js/9.f870735d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb058343.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">aurora blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/sountstars" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/sountstars" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>FE框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>React-Native</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FE/react-native/basic.html" aria-current="page" class="active sidebar-link">React-Native基本用法</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Servers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git命令</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-native基本用法"><a href="#react-native基本用法" class="header-anchor">#</a> React-Native基本用法</h1> <p></p><div class="table-of-contents"><ul><li><a href="#android-ios-安装">Android &amp; ios 安装</a><ul><li><a href="#ios">ios</a></li><li><a href="#android">Android</a></li></ul></li><li><a href="#切换页面触发刷新">切换页面触发刷新</a></li><li><a href="#内嵌webview">内嵌webview</a></li><li><a href="#payment-支付封装">payment 支付封装</a></li><li><a href="#年月日组件">年月日组件</a></li><li><a href="#蒙层组件">蒙层组件</a></li></ul></div><p></p> <h2 id="android-ios-安装"><a href="#android-ios-安装" class="header-anchor">#</a> Android &amp; ios 安装</h2> <h3 id="ios"><a href="#ios" class="header-anchor">#</a> ios</h3> <p>打开Xcode -&gt; Product -&gt; Scheme -&gt; Edit Scheme... -&gt; Run -&gt; Info -&gt; Build Configuration改成Release -&gt; Close -&gt; 在真机上运行 -&gt; 安装完成后需要改回Debug</p> <h3 id="android"><a href="#android" class="header-anchor">#</a> Android</h3> <p>打开Android Studio -&gt; Build -&gt; Generate Signed Bundle / APK... -&gt; 选择APK -&gt; Next -&gt; Key store path 选择项目android/app文件夹下的mentee-app.keystore,password/alias都填<strong>账号密码</strong> -&gt; Next -&gt; Build Variants选择release,Signature Versions 只勾选V1（个别应用商店可以接受V2签名，比如华为，Android11只能安装v2签名过的apk） -&gt; Finish -&gt; 将app-release.apk放到Android手机上安装或上传到应用商店</p> <p><strong>签名要注意,要和以前保持一致，不然后续可能会有问题</strong></p> <h2 id="切换页面触发刷新"><a href="#切换页面触发刷新" class="header-anchor">#</a> 切换页面触发刷新</h2> <div class="language-js extra-class"><pre class="language-js"><code>  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> unsubscribe <span class="token operator">=</span> navigation<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'focus'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 方法</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> unsubscribe<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>navigation<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="内嵌webview"><a href="#内嵌webview" class="header-anchor">#</a> 内嵌webview</h2> <p>使用<strong>react-native-webview</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> innerScript <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    window.App = {
      platform: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Platform<span class="token punctuation">.</span><span class="token constant">OS</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
      payment: {
        apple: (orderId,appleProductId) =&gt; window.ReactNativeWebView.postMessage(JSON.stringify({payment:{apple:{orderId,appleProductId}}})),
        wechat: (orderId) =&gt; window.ReactNativeWebView.postMessage(JSON.stringify({payment:{wechat:orderId}}))
      },
      navigation:{
        navigate: (screen) =&gt; window.ReactNativeWebView.postMessage(JSON.stringify({navigation:{navigate:{screen}}})),
        goBack: () =&gt; window.ReactNativeWebView.postMessage(JSON.stringify({navigation:{goBack:1}})),
        linkTo: (url) =&gt; window.ReactNativeWebView.postMessage(JSON.stringify({navigation:{linkTo:url}})),
      },
    };
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token function">judge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>WebView
      injectedJavaScriptBeforeContentLoaded<span class="token operator">=</span><span class="token punctuation">{</span>innerScript<span class="token punctuation">}</span>
      onMessage<span class="token operator">=</span><span class="token punctuation">{</span>handleMessage<span class="token punctuation">}</span>
      startInLoadingState<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span>
      source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        uri<span class="token operator">:</span> url<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
      mixedContentMode<span class="token operator">=</span><span class="token string">&quot;always&quot;</span>
      userAgent<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Android</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span>
      ref<span class="token operator">=</span><span class="token punctuation">{</span>webviewRef<span class="token punctuation">}</span>
      onNavigationStateChange<span class="token operator">=</span><span class="token punctuation">{</span>onNavigationStateChange<span class="token punctuation">}</span>
      onLoadProgress<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        Platform<span class="token punctuation">.</span><span class="token constant">OS</span> <span class="token operator">===</span> <span class="token string">'android'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">changeTitle</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>nativeEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
      onLoadEnd<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setLoad</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
      onError<span class="token operator">=</span><span class="token punctuation">{</span>handleWebViewError<span class="token punctuation">}</span>
      onHttpError<span class="token operator">=</span><span class="token punctuation">{</span>handleWebViewError<span class="token punctuation">}</span>
      allowsBackForwardNavigationGestures<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span>
      contentMode<span class="token operator">=</span><span class="token string">&quot;mobile&quot;</span>
      sharedCookiesEnabled<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span>
    <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>WebView<span class="token operator">&gt;</span>
</code></pre></div><h2 id="payment-支付封装"><a href="#payment-支付封装" class="header-anchor">#</a> payment 支付封装</h2> <p>使用<strong>react-native-iap</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> RNIap<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  purchaseUpdatedListener<span class="token punctuation">,</span>
  InAppPurchase<span class="token punctuation">,</span>
  SubscriptionPurchase<span class="token punctuation">,</span>
  finishTransaction<span class="token punctuation">,</span>
  purchaseErrorListener<span class="token punctuation">,</span>
  PurchaseError<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native-iap'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">usePayment</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
  purchaseUpdatedHandler<span class="token punctuation">,</span>
  purchaseErrorHandler<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> IProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> purchaseUpdateSubscription <span class="token operator">=</span> useRef<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> purchaseErrorSubscription <span class="token operator">=</span> useRef<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> RNIap<span class="token punctuation">.</span><span class="token function">initConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>code<span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    purchaseUpdateSubscription<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">purchaseUpdatedListener</span><span class="token punctuation">(</span>
      <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">purchase<span class="token operator">:</span> InAppPurchase <span class="token operator">|</span> SubscriptionPurchase</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>purchase<span class="token punctuation">.</span>transactionId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          purchaseUpdatedHandler <span class="token operator">&amp;&amp;</span> <span class="token function">purchaseUpdatedHandler</span><span class="token punctuation">(</span>purchase<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> receipt <span class="token operator">=</span> purchase<span class="token punctuation">.</span>transactionReceipt<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>receipt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> ackResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">finishTransaction</span><span class="token punctuation">(</span>purchase<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ackResult'</span><span class="token punctuation">,</span> ackResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>ackErr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'ackErr'</span><span class="token punctuation">,</span> ackErr<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    purchaseErrorSubscription<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">purchaseErrorListener</span><span class="token punctuation">(</span>
      <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token operator">:</span> PurchaseError</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        purchaseErrorHandler <span class="token operator">&amp;&amp;</span> <span class="token function">purchaseErrorHandler</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Platform<span class="token punctuation">.</span><span class="token constant">OS</span> <span class="token operator">===</span> <span class="token string">'ios'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      purchaseUpdateSubscription<span class="token operator">?.</span>current<span class="token operator">?.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      purchaseErrorSubscription<span class="token operator">?.</span>current<span class="token operator">?.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      RNIap<span class="token punctuation">.</span><span class="token function">endConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>purchaseUpdatedHandler<span class="token punctuation">,</span> purchaseErrorHandler<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">pay</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">sku<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> RNIap<span class="token punctuation">.</span><span class="token function">clearTransactionIOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> RNIap<span class="token punctuation">.</span><span class="token function">getProducts</span><span class="token punctuation">(</span><span class="token punctuation">[</span>sku<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> RNIap<span class="token punctuation">.</span><span class="token function">requestPurchase</span><span class="token punctuation">(</span>sku<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    pay<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="年月日组件"><a href="#年月日组件" class="header-anchor">#</a> 年月日组件</h2> <p><strong>SlideupMenu</strong> 弹窗蒙层组件<br> <code>类似下面图片组件</code></p> <p><img src="/assets/img/datepicker.88d32cf9.jpg" alt="solar"></p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> styles <span class="token operator">=</span> StyleSheet<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  root<span class="token operator">:</span> <span class="token punctuation">{</span>
    padding<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
    flexGrow<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  title<span class="token operator">:</span> <span class="token punctuation">{</span>
    fontSize<span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
    color<span class="token operator">:</span> <span class="token string">'#15161F'</span><span class="token punctuation">,</span>
    lineHeight<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  timeBody<span class="token operator">:</span> <span class="token punctuation">{</span>
    flexDirection<span class="token operator">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
    alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
    justifyContent<span class="token operator">:</span> <span class="token string">'space-between'</span><span class="token punctuation">,</span>
    marginTop<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  timeFont<span class="token operator">:</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token string">'#6E727A'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  inputBody<span class="token operator">:</span> <span class="token punctuation">{</span>
    marginTop<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  textInput<span class="token operator">:</span> <span class="token punctuation">{</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">'#F8F9FA'</span><span class="token punctuation">,</span>
    borderWidth<span class="token operator">:</span> StyleSheet<span class="token punctuation">.</span>hairlineWidth<span class="token punctuation">,</span>
    borderRadius<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">126</span><span class="token punctuation">,</span>
    flexGrow<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    paddingVertical<span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
    paddingHorizontal<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    borderColor<span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
    marginBottom<span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">,</span>
    fontSize<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    lineHeight<span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
    marginTop<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  sumbitBtn<span class="token operator">:</span> <span class="token punctuation">{</span>
    bottom<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    flexDirection<span class="token operator">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
    paddingBottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  arrowDown<span class="token operator">:</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mark<span class="token operator">:</span> <span class="token punctuation">{</span>
    position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
    top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    right<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">'rgba(21, 22, 31, 0.3)'</span><span class="token punctuation">,</span>
    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
    alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pickerBody<span class="token operator">:</span> <span class="token punctuation">{</span>
    height<span class="token operator">:</span> <span class="token number">260</span><span class="token punctuation">,</span>
    position<span class="token operator">:</span> <span class="token string">'relative'</span><span class="token punctuation">,</span>
    flexDirection<span class="token operator">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Process</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> navigation<span class="token punctuation">,</span> route <span class="token punctuation">}</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>date<span class="token punctuation">,</span> setDate<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY-MM-DD'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>visiable<span class="token punctuation">,</span> setVisiable<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// const navigation = useNavigation();</span>
  <span class="token keyword">const</span> scrollerRef <span class="token operator">=</span> useRef<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> scrollerRefDay <span class="token operator">=</span> useRef<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>currentMonth<span class="token punctuation">,</span> setCurrentMonth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token string">'2021-1-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>year<span class="token punctuation">,</span> setYear<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>time<span class="token punctuation">,</span> setTime<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>object<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> month <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">2021</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> arr<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">2200</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> a<span class="token punctuation">;</span> a<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">setYear</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> days <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>currentMonth<span class="token punctuation">.</span><span class="token function">daysInMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>currentMonth<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> unsubscribe <span class="token operator">=</span> navigation<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'focus'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setDate</span><span class="token punctuation">(</span><span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY-MM-DD'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> unsubscribe<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>navigation<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleScroll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any<span class="token punctuation">,</span> str<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>nativeEvent<span class="token punctuation">.</span>contentOffset<span class="token punctuation">.</span>y <span class="token operator">/</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'month'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>time<span class="token punctuation">,</span>
        month<span class="token operator">:</span> month<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'year'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>time<span class="token punctuation">,</span>
        year<span class="token operator">:</span> year<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'day'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>time<span class="token punctuation">,</span>
        day<span class="token operator">:</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleScrollEnd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> any<span class="token punctuation">,</span> str<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>nativeEvent<span class="token punctuation">.</span>contentOffset<span class="token punctuation">.</span>y <span class="token operator">/</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'month'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">changeDay</span><span class="token punctuation">(</span>month<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>time<span class="token punctuation">,</span>
        month<span class="token operator">:</span> month<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'year'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>time<span class="token punctuation">,</span>
        year<span class="token operator">:</span> year<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">changeDay</span><span class="token punctuation">(</span>time<span class="token operator">?.</span>month <span class="token operator">?</span> time<span class="token operator">?.</span>month <span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'M'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">===</span> <span class="token string">'day'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>time<span class="token punctuation">,</span>
        day<span class="token operator">:</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">changeDay</span><span class="token punctuation">(</span>time<span class="token operator">?.</span>month <span class="token operator">?</span> time<span class="token operator">?.</span>month <span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'M'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">changeDay</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">month<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>time<span class="token operator">?.</span>day <span class="token operator">||</span> time<span class="token operator">?.</span>day <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> month31 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> month30 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>month31<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>month30<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token operator">?.</span>day <span class="token operator">===</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        scrollerRefDay<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          y<span class="token operator">:</span> <span class="token number">29</span> <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token operator">?.</span>year <span class="token operator">&amp;&amp;</span> time<span class="token operator">?.</span>year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token operator">?.</span>day <span class="token operator">&lt;</span> <span class="token number">29</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        scrollerRefDay<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          y<span class="token operator">:</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time<span class="token operator">?.</span>day <span class="token operator">&lt;</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        scrollerRefDay<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          y<span class="token operator">:</span> <span class="token number">27</span> <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">confirm</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setDate</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>time<span class="token operator">?.</span>year <span class="token operator">?</span> time<span class="token operator">?.</span>year <span class="token operator">:</span> <span class="token function">dayjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
        time<span class="token operator">?.</span>month <span class="token operator">?</span> time<span class="token operator">?.</span>month <span class="token operator">:</span> <span class="token number">1</span>
      <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>time<span class="token operator">?.</span>day <span class="token operator">?</span> time<span class="token operator">?.</span>day <span class="token operator">:</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setVisiable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> judge <span class="token operator">=</span> route<span class="token operator">?.</span>params<span class="token operator">?.</span>title <span class="token operator">===</span> <span class="token string">'技能专项提升'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>SlideupMenu
        show<span class="token operator">=</span><span class="token punctuation">{</span>visiable<span class="token punctuation">}</span>
        showClosePosition<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span>
        title<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
        onClose<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setVisiable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>pickerBody<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>View
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              height<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
              borderBottomColor<span class="token operator">:</span> <span class="token string">'#ECECEC'</span><span class="token punctuation">,</span>
              borderBottomWidth<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
              width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
              position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
              zIndex<span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
              backgroundColor<span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
              alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
              justifyContent<span class="token operator">:</span> <span class="token string">'space-between'</span><span class="token punctuation">,</span>
              flexDirection<span class="token operator">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
              paddingHorizontal<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>TouchableOpacity
              style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
                alignItems<span class="token operator">:</span> <span class="token string">'flex-start'</span><span class="token punctuation">,</span>
                justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span>
              onPress<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">setVisiable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>Text
                style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                  fontSize<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
                  color<span class="token operator">:</span> <span class="token string">'#999999'</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">}</span>
              <span class="token operator">&gt;</span>
                取消
              <span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>TouchableOpacity<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>TouchableOpacity
              style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
                alignItems<span class="token operator">:</span> <span class="token string">'flex-end'</span><span class="token punctuation">,</span>
                justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                width<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span>
              onPress<span class="token operator">=</span><span class="token punctuation">{</span>confirm<span class="token punctuation">}</span>
            <span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>Text
                style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                  fontSize<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
                  color<span class="token operator">:</span> <span class="token string">'#0B56F8'</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">}</span>
              <span class="token operator">&gt;</span>
                确认
              <span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>TouchableOpacity<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Image
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
              top<span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
              width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
              height<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
              zIndex<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
            source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/gradualWhite.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
          <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Image
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
              top<span class="token operator">:</span> <span class="token number">183</span><span class="token punctuation">,</span>
              width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
              height<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
              zIndex<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">,</span>
              transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>rotateX<span class="token operator">:</span><span class="token string">'180deg'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
            source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/gradualWhite.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
          <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>View
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
              height<span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
              borderTopColor<span class="token operator">:</span> <span class="token string">'#ECECEC'</span><span class="token punctuation">,</span>
              borderTopWidth<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
              borderBottomColor<span class="token operator">:</span> <span class="token string">'#ECECEC'</span><span class="token punctuation">,</span>
              borderBottomWidth<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
              width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
              top<span class="token operator">:</span> <span class="token number">130</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token comment">/* year */</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>ScrollView
            ref<span class="token operator">=</span><span class="token punctuation">{</span>scrollerRef<span class="token punctuation">}</span>
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              height<span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
              flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
            snapToInterval<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">40</span><span class="token punctuation">}</span>
            snapToAlignment<span class="token operator">=</span><span class="token string">&quot;start&quot;</span>
            disableIntervalMomentum<span class="token operator">=</span><span class="token punctuation">{</span>Platform<span class="token punctuation">.</span><span class="token constant">OS</span> <span class="token operator">===</span> <span class="token string">'android'</span><span class="token punctuation">}</span>
            scrollEventThrottle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span>
            onScroll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleScroll</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            onMomentumScrollEnd<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleScrollEnd</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            showsVerticalScrollIndicator<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span>
          <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> paddingVertical<span class="token operator">:</span> <span class="token number">70</span><span class="token punctuation">,</span> marginTop<span class="token operator">:</span> <span class="token number">60</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token punctuation">{</span>year<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
                <span class="token operator">&lt;</span>View
                  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                    height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
                    alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span>
                  key<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>Text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>v<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">年</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
              <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>ScrollView<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token comment">/* month */</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>ScrollView
            ref<span class="token operator">=</span><span class="token punctuation">{</span>scrollerRef<span class="token punctuation">}</span>
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              height<span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
              flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
            snapToInterval<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">40</span><span class="token punctuation">}</span>
            snapToAlignment<span class="token operator">=</span><span class="token string">&quot;start&quot;</span>
            disableIntervalMomentum<span class="token operator">=</span><span class="token punctuation">{</span>Platform<span class="token punctuation">.</span><span class="token constant">OS</span> <span class="token operator">===</span> <span class="token string">'android'</span><span class="token punctuation">}</span>
            scrollEventThrottle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span>
            onScroll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleScroll</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'month'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            onMomentumScrollEnd<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleScrollEnd</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'month'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            showsVerticalScrollIndicator<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span>
          <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> paddingVertical<span class="token operator">:</span> <span class="token number">70</span><span class="token punctuation">,</span> marginTop<span class="token operator">:</span> <span class="token number">60</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token punctuation">{</span>month<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
                <span class="token operator">&lt;</span>View
                  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                    height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
                    alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span>
                  key<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>Text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>v<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">月</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
              <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>ScrollView<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token comment">/* day */</span><span class="token punctuation">}</span>
          <span class="token operator">&lt;</span>ScrollView
            ref<span class="token operator">=</span><span class="token punctuation">{</span>scrollerRefDay<span class="token punctuation">}</span>
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              height<span class="token operator">:</span> <span class="token number">240</span><span class="token punctuation">,</span>
              flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
            snapToInterval<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">40</span><span class="token punctuation">}</span>
            snapToAlignment<span class="token operator">=</span><span class="token string">&quot;start&quot;</span>
            disableIntervalMomentum<span class="token operator">=</span><span class="token punctuation">{</span>Platform<span class="token punctuation">.</span><span class="token constant">OS</span> <span class="token operator">===</span> <span class="token string">'android'</span><span class="token punctuation">}</span>
            scrollEventThrottle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span>
            onScroll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleScroll</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            onMomentumScrollEnd<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handleScrollEnd</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            showsVerticalScrollIndicator<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span>
          <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> paddingVertical<span class="token operator">:</span> <span class="token number">70</span><span class="token punctuation">,</span> marginTop<span class="token operator">:</span> <span class="token number">60</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token punctuation">{</span>days<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
                <span class="token operator">&lt;</span>View
                  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                    height<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
                    alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span>
                  key<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>Text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">日</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
              <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>ScrollView<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>SlideupMenu<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="蒙层组件"><a href="#蒙层组件" class="header-anchor">#</a> 蒙层组件</h2> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> styles <span class="token operator">=</span> StyleSheet<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sheet<span class="token operator">:</span> <span class="token punctuation">{</span>
    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
    alignItems<span class="token operator">:</span> <span class="token string">'stretch'</span><span class="token punctuation">,</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
    borderTopLeftRadius<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    borderTopRightRadius<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  header<span class="token operator">:</span> <span class="token punctuation">{</span>
    flexDirection<span class="token operator">:</span> <span class="token string">'row'</span><span class="token punctuation">,</span>
    justifyContent<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
    alignItems<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
    padding<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  title<span class="token operator">:</span> <span class="token punctuation">{</span>
    fontSize<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    color<span class="token operator">:</span> <span class="token string">'#222'</span><span class="token punctuation">,</span>
    lineHeight<span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  closeLeft<span class="token operator">:</span> <span class="token punctuation">{</span>
    position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
    left<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
    top<span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  closeRight<span class="token operator">:</span> <span class="token punctuation">{</span>
    position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
    right<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
    top<span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  closeIcon<span class="token operator">:</span> <span class="token punctuation">{</span>
    height<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    width<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  show<span class="token operator">:</span> boolean<span class="token punctuation">;</span>
  title<span class="token operator">:</span> string<span class="token punctuation">;</span>
  <span class="token function-variable function">onClose</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  closePosition<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'left'</span> <span class="token operator">|</span> <span class="token string">'right'</span><span class="token punctuation">;</span>
  children<span class="token operator">?</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
  showClosePosition<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span> <span class="token comment">//是否显示关闭符号</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">SlideupMenu</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  show<span class="token punctuation">,</span>
  title<span class="token punctuation">,</span>
  onClose<span class="token punctuation">,</span>
  children<span class="token punctuation">,</span>
  closePosition <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">,</span>
  showClosePosition <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> IProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> slideAnimate <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Animated<span class="token punctuation">.</span>Value</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>current<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>visible<span class="token punctuation">,</span> setVisible<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">slideIn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Animated<span class="token punctuation">.</span><span class="token function">timing</span><span class="token punctuation">(</span>slideAnimate<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      toValue<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      duration<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      useNativeDriver<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">slideOut</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Animated<span class="token punctuation">.</span><span class="token function">timing</span><span class="token punctuation">(</span>slideAnimate<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      toValue<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      duration<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      useNativeDriver<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> finished <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>finished<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>show<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">slideIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">slideOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>show<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    onClose <span class="token operator">&amp;&amp;</span> <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Modal visible<span class="token operator">=</span><span class="token punctuation">{</span>visible<span class="token punctuation">}</span> transparent<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span> animationType<span class="token operator">=</span><span class="token string">&quot;fade&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> backgroundColor<span class="token operator">:</span> <span class="token string">'rgba(0,0,0,0.5)'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>TouchableWithoutFeedback onPress<span class="token operator">=</span><span class="token punctuation">{</span>handleClose<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>View
            style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
              flexGrow<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>TouchableWithoutFeedback<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Animated<span class="token punctuation">.</span>View
          style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>styles<span class="token punctuation">.</span>sheet<span class="token punctuation">,</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> translateY<span class="token operator">:</span> slideAnimate <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          <span class="token punctuation">{</span>showClosePosition <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>header<span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token punctuation">{</span>closePosition <span class="token operator">===</span> <span class="token string">'left'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
                <span class="token operator">&lt;</span>TouchableOpacity
                  style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>closeLeft<span class="token punctuation">}</span>
                  onPress<span class="token operator">=</span><span class="token punctuation">{</span>handleClose<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>Image
                    source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../assets/close-icon.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                    style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>closeIcon<span class="token punctuation">}</span>
                  <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Image<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>TouchableOpacity<span class="token operator">&gt;</span>
              <span class="token punctuation">)</span><span class="token punctuation">}</span>
              <span class="token operator">&lt;</span>Text<span class="token operator">&gt;</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Text<span class="token operator">&gt;</span>
              <span class="token punctuation">{</span>closePosition <span class="token operator">===</span> <span class="token string">'right'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
                <span class="token operator">&lt;</span>TouchableOpacity
                  style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>closeRight<span class="token punctuation">}</span>
                  onPress<span class="token operator">=</span><span class="token punctuation">{</span>handleClose<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>Image
                    source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../assets/close-icon.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                    style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>closeIcon<span class="token punctuation">}</span>
                  <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Image<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>TouchableOpacity<span class="token operator">&gt;</span>
              <span class="token punctuation">)</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
          <span class="token punctuation">)</span><span class="token punctuation">}</span>
          <span class="token punctuation">{</span>children <span class="token operator">&amp;&amp;</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Animated<span class="token punctuation">.</span>View<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Modal<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/FE/vue/basic.html" class="prev">
        vue基本用法
      </a></span> <span class="next"><a href="/webpack/basic.html">
        Webpack配置详解
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a4e80abf.js" defer></script><script src="/assets/js/2.52866a67.js" defer></script><script src="/assets/js/14.31a9b0f4.js" defer></script>
  </body>
</html>
